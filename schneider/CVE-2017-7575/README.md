# Obtencion remota de credenciales en texto claro en Schneider-Electric Modicon TM221CE16R (CVE-2017-7575)
Los investigadores de seguridad Simon Heming, Maik Brüggemann, Hendrik Schwartke y Ralf Spenneberg han descubierto una vulnerabilidad que permite a atacantes con conexión al dispositivo afectado, obtener contraseñas sin cifrar tras el envío de una petición.

# Error en el mecanismo de protección:
La función Application Protection es usada para prevenir la transferencia de la aplicación desde el controlador lógico al software SoMachine Basic. Un comando específicamente formado puede ser enviado vía Modbus TCP por el puerto 502 al controlador lógico y este devolverá la contraseña sin cifrar. Tras la obtención de la contraseña un atacante puede acceder a la aplicación "SoMachine Basic" para descargar, modificar y posteriormente cargar de nuevo cualquier aplicación. Se ha publicado el  identificador *CVE-2017-7575* para esta vulnerabilidad.


## Vulnerable:
* Schneider-Electric Modicon TM221CE16R 1.3.3.3

## [Actualizacion 17/04/2017]
* Schneider Modicon M221 PLC todas las versiones firmware hasta la versión v1.5.0.1
* SoMachine Basic todas las versiones software hasta la versión v1.5

## Uso / usage

	usr@pwn:~$ git clone https://github.com/ezelf/ics_exploits.git
	usr@pwn:~$ cd ics_exploits/schneider/CVE-2017-7575/
	usr@pwn:~$ python password_m221.py <host PLC> 

## poc	
![poc_m221](screenshot/indoor/poc_1.png)



Referencia: https://www.industrial.army/2020/06/obtencion-remota-de-credenciales-en.html

Saludos,
Industrial Army.